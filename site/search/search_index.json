{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Controle Financeiro Documentation","text":"<p>Welcome to the official documentation for the Controle Financeiro project.</p>"},{"location":"#quick-links","title":"Quick Links","text":"<ul> <li> <p> Project Overview Learn about the goals, tech stack, and roadmap.</p> </li> <li> <p> Architecture High-level system design and data flow.</p> </li> <li> <p> Database Schema Detailed SQL schema and relationships.</p> </li> <li> <p> API Reference Complete documentation of backend endpoints.</p> </li> </ul>"},{"location":"#core-features","title":"Core Features","text":"<ul> <li>Login &amp; Auth: Secure JWT authentication.</li> <li>Group Management: Share finances with family/partners.</li> <li>AI Advisor: Get personalized insights powered by Gemini.</li> </ul>"},{"location":"#getting-started","title":"Getting Started","text":"<ol> <li>Check the Setup &amp; Installation guide.</li> <li>Review the Security Practices.</li> <li>Explore the Frontend Components.</li> </ol> <p>Generated for version 1.0.0</p>"},{"location":"api_endpoints/","title":"API Endpoints","text":"<p>The backend is built with Node.js and Express. All API routes are prefixed with <code>/api</code>.</p> <p>Base URL: <code>http://localhost:3000/api</code></p>"},{"location":"api_endpoints/#authentication","title":"Authentication","text":""},{"location":"api_endpoints/#login","title":"Login","text":"<ul> <li>Endpoint: <code>POST /auth/login</code></li> <li>Body: <code>{ \"username\": \"user\", \"password\": \"password\" }</code></li> <li>Response: <code>{ \"token\": \"jwt_token...\", \"username\": \"user\", \"success\": true }</code></li> </ul>"},{"location":"api_endpoints/#validate-token","title":"Validate Token","text":"<ul> <li>Endpoint: <code>GET /auth/validate</code></li> <li>Headers: <code>Authorization: Bearer &lt;token&gt;</code></li> <li>Response: <code>{ \"valid\": true, \"username\": \"user\" }</code></li> </ul>"},{"location":"api_endpoints/#groups-management","title":"Groups Management","text":"<p>Requires <code>Authorization</code> header.</p>"},{"location":"api_endpoints/#list-groups","title":"List Groups","text":"<ul> <li>Endpoint: <code>GET /groups</code></li> <li>Response: List of groups the user belongs to.</li> </ul>"},{"location":"api_endpoints/#create-group","title":"Create Group","text":"<ul> <li>Endpoint: <code>POST /groups</code></li> <li>Body: <code>{ \"name\": \"My Family Group\" }</code></li> <li>Response: <code>{ \"id\": \"uuid\", \"name\": \"...\", \"role\": \"admin\" }</code></li> </ul>"},{"location":"api_endpoints/#get-group-details","title":"Get Group Details","text":"<ul> <li>Endpoint: <code>GET /groups/:id</code></li> <li>Headers: <code>X-Group-ID: &lt;group_id&gt;</code></li> <li>Response: Group metadata (id, name, created_at).</li> </ul>"},{"location":"api_endpoints/#update-group","title":"Update Group","text":"<ul> <li>Endpoint: <code>PUT /groups/:id</code></li> <li>Headers: <ul> <li><code>Authorization: Bearer &lt;token&gt;</code></li> <li><code>X-Group-ID: &lt;group_id&gt;</code></li> </ul> </li> <li>Body: <code>{ \"name\": \"New Group Name\" }</code></li> <li>Response: Updated group object.</li> <li>Note: Admin only.</li> </ul>"},{"location":"api_endpoints/#delete-group","title":"Delete Group","text":"<ul> <li>Endpoint: <code>DELETE /groups/:id</code></li> <li>Headers: <ul> <li><code>Authorization: Bearer &lt;token&gt;</code></li> <li><code>X-Group-ID: &lt;group_id&gt;</code></li> </ul> </li> <li>Response: <code>{ \"message\": \"Group deleted successfully\" }</code></li> <li>Note: Admin only.</li> </ul>"},{"location":"api_endpoints/#invite-user","title":"Invite User","text":"<ul> <li>Endpoint: <code>POST /groups/:id/invite</code></li> <li>Headers: <code>X-Group-ID: &lt;group_id&gt;</code></li> <li>Body: <code>{ \"username\": \"julia.ferreira\" }</code></li> <li>Note: Admin only.</li> </ul>"},{"location":"api_endpoints/#financial-resources","title":"Financial Resources","text":"<p>All financial endpoints require: 1. <code>Authorization: Bearer &lt;token&gt;</code> 2. <code>X-Group-ID: &lt;group_id&gt;</code></p>"},{"location":"api_endpoints/#bills-fixed-expenses","title":"Bills (Fixed Expenses)","text":"<ul> <li><code>GET /bills</code>: List all bills.</li> <li><code>POST /bills</code>: Create bill. Body: <code>{ \"name\", \"value\", \"dueDate\", \"status\" }</code></li> <li><code>DELETE /bills/:id</code>: Delete bill.</li> <li><code>PATCH /bills/:id/pay</code>: Mark as paid.</li> </ul>"},{"location":"api_endpoints/#incomes","title":"Incomes","text":"<ul> <li><code>GET /incomes</code>: List incomes.</li> <li><code>POST /incomes</code>: Create income. Body: <code>{ \"description\", \"value\", \"date\" }</code></li> <li><code>DELETE /incomes/:id</code>: Delete income.</li> </ul>"},{"location":"api_endpoints/#investments","title":"Investments","text":"<ul> <li><code>GET /investments</code>: List investments.</li> <li><code>POST /investments</code>: Create investment. Body: <code>{ \"name\", \"initialAmount\", \"cdiPercent\", \"startDate\", \"durationMonths\" }</code></li> <li><code>DELETE /investments/:id</code>: Delete investment.</li> </ul>"},{"location":"api_endpoints/#random-expenses-variable","title":"Random Expenses (Variable)","text":"<ul> <li><code>GET /random-expenses</code>: List expenses.</li> <li><code>POST /random-expenses</code>: Create expense. Body: <code>{ \"name\", \"value\", \"date\", \"status\" }</code></li> <li><code>DELETE /random-expenses/:id</code>: Delete expense.</li> <li><code>PATCH /random-expenses/:id/pay</code>: Mark as paid.</li> </ul>"},{"location":"api_endpoints/#ai-advisor","title":"AI Advisor","text":"<ul> <li>Endpoint: <code>POST /advisor</code></li> <li>Headers: <code>Authorization</code>, <code>X-Group-ID</code></li> <li>Description: Aggregates all group financial data and uses Google Gemini to generate a financial diagnosis and strategy.</li> <li>Caching: Responses are cached in Redis for 24 hours if the underlying data hasn't changed (hash-based invalidation).</li> </ul>"},{"location":"architecture/","title":"Architecture","text":"<p>The project follows a standard Monorepo-like structure (though currently in a single repo without workspaces) separating the Client (Frontend) and Server (Backend).</p>"},{"location":"architecture/#high-level-diagram","title":"High-Level Diagram","text":"<pre><code>graph TD\n    Client[React Frontend] &lt;--&gt;|REST API / JSON| Server[Node.js Express API]\n    Server &lt;--&gt;|SQL| DB[(PostgreSQL)]\n    Server &lt;--&gt;|Cache| Cache[(Redis)]\n    Server &lt;--&gt;|Generative AI| AI[Google Gemini API]\n</code></pre>"},{"location":"architecture/#backend-server","title":"Backend (<code>/server</code>)","text":"<ul> <li>Runtime: Node.js</li> <li>Framework: Express.js</li> <li>Database Driver: <code>pg</code> (node-postgres)</li> <li>AI Integration: <code>@google/generative-ai</code></li> <li>Caching: <code>redis</code> (Used for caching Gemini AI responses for 24h to save costs/tokens).</li> <li>Key Files:<ul> <li><code>index.js</code>: Main entry point, contains all routes and logic (Monolithic file pattern - Candidate for refactoring).</li> </ul> </li> </ul>"},{"location":"architecture/#frontend-src","title":"Frontend (<code>/src</code>)","text":"<ul> <li>Framework: React 19 (via Vite)</li> <li>Language: TypeScript</li> <li>Styling: Tailwind CSS</li> <li>State Management: React Context API (<code>AuthContext</code>, <code>GroupContext</code>).</li> <li>Routing: React Router DOM.</li> <li>Icons: Lucide React.</li> </ul>"},{"location":"architecture/#deployment-infrastructure","title":"Deployment / Infrastructure","text":"<ul> <li>Containerization: Docker &amp; Docker Compose.</li> <li>Services:<ul> <li><code>app</code>: Frontend (Nginx serving static build).</li> <li><code>server</code>: Node.js backend.</li> <li><code>db</code>: PostgreSQL 13+.</li> <li><code>redis</code>: Redis cache.</li> </ul> </li> </ul>"},{"location":"atualizacaov101/","title":"Plano de Atualiza\u00e7\u00e3o e Melhorias - v1.0.1","text":"<p>Este documento detalha as oportunidades de melhoria identificadas para o projeto Controle Financeiro, visando escalabilidade, seguran\u00e7a e melhor experi\u00eancia do usu\u00e1rio.</p>"},{"location":"atualizacaov101/#1-arquitetura-do-backend-refatoracao","title":"1. Arquitetura do Backend (Refatora\u00e7\u00e3o)","text":"<ul> <li>Modulariza\u00e7\u00e3o: Separar o <code>server/index.js</code> em <code>routes/</code>, <code>controllers/</code> e <code>services/</code>.</li> <li>Middleware de Erro: Implementar um tratador de erros global para respostas padronizadas.</li> <li>Valida\u00e7\u00e3o de Dados: Utilizar bibliotecas como <code>zod</code> ou <code>joi</code> para validar entradas da API.</li> </ul>"},{"location":"atualizacaov101/#2-banco-de-dados-performance-e-estrutura","title":"2. Banco de Dados (Performance e Estrutura)","text":"<ul> <li>\u00cdndices: Adicionar \u00edndices nas colunas <code>group_id</code> e <code>user_id</code> em todas as tabelas financeiras.</li> <li>Categoriza\u00e7\u00e3o: Implementar tabela de <code>categories</code> para classificar gastos e rendas.</li> <li>Soft Delete: Considerar o uso de <code>deleted_at</code> em vez de dele\u00e7\u00e3o f\u00edsica para manter hist\u00f3rico.</li> </ul>"},{"location":"atualizacaov101/#3-novas-funcionalidades-ux","title":"3. Novas Funcionalidades (UX)","text":"<ul> <li>Recorr\u00eancia: Suporte para contas que se repetem mensalmente/anualmente.</li> <li>Metas Financeiras: Sistema de acompanhamento de metas e economia.</li> <li>Exporta\u00e7\u00e3o: Gera\u00e7\u00e3o de relat\u00f3rios em PDF e Excel (XLSX).</li> </ul>"},{"location":"atualizacaov101/#4-inteligencia-artificial-ai-advisor","title":"4. Intelig\u00eancia Artificial (AI Advisor)","text":"<ul> <li>Hist\u00f3rico Contextual: Enviar tend\u00eancias de meses anteriores para an\u00e1lises comparativas.</li> <li>Chat Interativo: Permitir perguntas diretas do usu\u00e1rio sobre seus dados financeiros.</li> <li>Melhoria de Prompts: Refinar instru\u00e7\u00f5es para insights mais acion\u00e1veis.</li> </ul>"},{"location":"atualizacaov101/#5-frontend-e-uiux","title":"5. Frontend e UI/UX","text":"<ul> <li>Pagina\u00e7\u00e3o: Implementar nas listas de contas e gastos para suportar grandes volumes de dados.</li> <li>Tema Dark Mode: Suporte completo a tema escuro usando Tailwind CSS.</li> <li>Feedback Visual: Melhorar estados de loading e toasts de notifica\u00e7\u00e3o.</li> </ul> <p>Documento gerado em 07 de Fevereiro de 2026.</p>"},{"location":"contexts/","title":"React Contexts","text":"<p>The application uses the Context API for global state management, avoiding prop drilling.</p>"},{"location":"contexts/#provider-hierarchy","title":"Provider Hierarchy","text":"<pre><code>&lt;AuthProvider&gt;\n  &lt;GroupProvider&gt;\n    &lt;FinanceProvider&gt;\n      &lt;App /&gt;\n    &lt;/FinanceProvider&gt;\n  &lt;/GroupProvider&gt;\n&lt;/AuthProvider&gt;\n</code></pre>"},{"location":"contexts/#authcontext","title":"<code>AuthContext</code>","text":"<ul> <li>State: <code>user</code> (User object), <code>token</code> (JWT), <code>isAuthenticated</code> (boolean).</li> <li>Actions: <code>login(username, password)</code>, <code>logout()</code>.</li> <li>Persistance: Checks <code>localStorage</code> on initialization to restore session.</li> </ul>"},{"location":"contexts/#groupcontext","title":"<code>GroupContext</code>","text":"<ul> <li>Dependencies: Requires <code>AuthContext</code>.</li> <li>State:<ul> <li><code>groups</code>: List of groups the user belongs to.</li> <li><code>currentGroup</code>: The currently selected group object.</li> </ul> </li> <li>Actions:<ul> <li><code>selectGroup(groupId)</code>: Switches the active tenant.</li> <li><code>refreshGroups()</code>: Re-fetches the list from the API.</li> </ul> </li> </ul>"},{"location":"contexts/#financecontext","title":"<code>FinanceContext</code>","text":"<ul> <li>Dependencies: Requires <code>GroupContext</code>.</li> <li>State:<ul> <li><code>bills</code>, <code>incomes</code>, <code>investments</code>, <code>randomExpenses</code>: Arrays of data.</li> <li><code>loading</code>: Boolean flag for async operations.</li> </ul> </li> <li>Actions:<ul> <li><code>fetchData()</code>: Loads all data for the currentGroup.</li> <li><code>addBill()</code>, <code>payBill()</code>, <code>deleteBill()</code>, etc.: Wrappers around API calls that also update local state upon success.</li> </ul> </li> <li>Behavior: automatically re-fetches data whenever <code>currentGroup</code> changes.</li> </ul>"},{"location":"database_schema/","title":"Database Schema","text":"<p>The application uses a PostgreSQL database. The schema has evolved to support group-based financial management (multi-tenancy where a group is a tenant).</p>"},{"location":"database_schema/#tables","title":"Tables","text":""},{"location":"database_schema/#users","title":"<code>users</code>","text":"<p>Stores user authentication information. - <code>id</code> (UUID, PK): Unique identifier. - <code>username</code> (VARCHAR): User's login name. - <code>password_hash</code> (VARCHAR): BCrypt hashed password. - <code>created_at</code> (TIMESTAMP): Creation timestamp.</p>"},{"location":"database_schema/#finance_groups","title":"<code>finance_groups</code>","text":"<p>Represents a shared financial context (e.g., a family or couple). - <code>id</code> (UUID, PK): Unique identifier. - <code>name</code> (VARCHAR): Name of the group. - <code>created_at</code> (TIMESTAMP): Creation timestamp.</p>"},{"location":"database_schema/#group_members","title":"<code>group_members</code>","text":"<p>Links users to groups and defines their permissions. - <code>id</code> (UUID, PK): Unique identifier. - <code>group_id</code> (UUID, FK -&gt; <code>finance_groups</code>): The group. - <code>user_id</code> (UUID, FK -&gt; <code>users</code>): The user. - <code>role</code> (VARCHAR): 'admin', 'editor', or 'viewer'. - <code>joined_at</code> (TIMESTAMP): When the user joined.</p>"},{"location":"database_schema/#financial-entities","title":"Financial Entities","text":"<p>All financial entities are now linked to a <code>group_id</code>. The <code>user_id</code> column exists for audit/legacy purposes but ownership is defined by the group.</p>"},{"location":"database_schema/#bills-recurringscheduled-payments","title":"<code>bills</code> (Recurring/Scheduled Payments)","text":"<ul> <li><code>id</code> (UUID, PK)</li> <li><code>group_id</code> (UUID, FK)</li> <li><code>user_id</code> (UUID, FK)</li> <li><code>name</code> (VARCHAR): Description of the bill.</li> <li><code>value</code> (DECIMAL): Amount.</li> <li><code>due_date</code> (DATE): When the bill is due.</li> <li><code>status</code> (VARCHAR): 'pending', 'paid', 'overdue'.</li> <li><code>paid_date</code> (TIMESTAMP): When it was actually paid.</li> </ul>"},{"location":"database_schema/#incomes-revenue","title":"<code>incomes</code> (Revenue)","text":"<ul> <li><code>id</code> (UUID, PK)</li> <li><code>group_id</code> (UUID, FK)</li> <li><code>user_id</code> (UUID, FK)</li> <li><code>description</code> (VARCHAR): Source of income.</li> <li><code>value</code> (DECIMAL): Amount.</li> <li><code>date</code> (DATE): Date of receipt.</li> </ul>"},{"location":"database_schema/#investments-savingsassets","title":"<code>investments</code> (Savings/Assets)","text":"<ul> <li><code>id</code> (UUID, PK)</li> <li><code>group_id</code> (UUID, FK)</li> <li><code>user_id</code> (UUID, FK)</li> <li><code>name</code> (VARCHAR): Name of investment (e.g., \"CDB Bank X\").</li> <li><code>initial_amount</code> (DECIMAL): Starting principal.</li> <li><code>cdi_percent</code> (INTEGER): Yield relative to CDI (default 100).</li> <li><code>start_date</code> (DATE): Investment start date.</li> <li><code>duration_months</code> (INTEGER): Maturity period.</li> </ul>"},{"location":"database_schema/#random_expenses-one-off-spendings","title":"<code>random_expenses</code> (One-off Spendings)","text":"<ul> <li><code>id</code> (UUID, PK)</li> <li><code>group_id</code> (UUID, FK)</li> <li><code>user_id</code> (UUID, FK)</li> <li><code>name</code> (VARCHAR): Description.</li> <li><code>value</code> (DECIMAL): Amount.</li> <li><code>date</code> (DATE): Date of expense.</li> <li><code>status</code> (VARCHAR): 'pending', 'paid', 'overdue'.</li> </ul>"},{"location":"database_schema/#entity-relationship-diagram-mermaid","title":"Entity Relationship Diagram (Mermaid)","text":"<pre><code>erDiagram\n    USERS ||--o{ GROUP_MEMBERS : \"joins\"\n    FINANCE_GROUPS ||--o{ GROUP_MEMBERS : \"has\"\n    FINANCE_GROUPS ||--o{ BILLS : \"owns\"\n    FINANCE_GROUPS ||--o{ INCOMES : \"owns\"\n    FINANCE_GROUPS ||--o{ INVESTMENTS : \"owns\"\n    FINANCE_GROUPS ||--o{ RANDOM_EXPENSES : \"owns\"\n\n    USERS {\n        UUID id PK\n        string username\n    }\n    FINANCE_GROUPS {\n        UUID id PK\n        string name\n    }\n    GROUP_MEMBERS {\n        UUID group_id FK\n        UUID user_id FK\n        string role\n    }\n    BILLS {\n        UUID group_id FK\n        decimal value\n        string status\n    }\n</code></pre>"},{"location":"frontend_components/","title":"Frontend Components","text":"<p>The frontend is built with React 19 and TypeScript, styled with Tailwind CSS.</p>"},{"location":"frontend_components/#directory-structure","title":"Directory Structure","text":"<p>Components are located in <code>src/components/</code>.</p>"},{"location":"frontend_components/#core-components","title":"Core Components","text":""},{"location":"frontend_components/#layout-layouttsx","title":"<code>Layout</code> (<code>Layout.tsx</code>)","text":"<ul> <li>Purpose: Wraps all authenticated pages.</li> <li>Features:<ul> <li>Responsive sidebar/navigation.</li> <li>Displays current user and selected group.</li> <li>Logout functionality.</li> </ul> </li> </ul>"},{"location":"frontend_components/#dashboard-dashboardtsx","title":"<code>Dashboard</code> (<code>Dashboard.tsx</code>)","text":"<ul> <li>Purpose: Main overview page.</li> <li>Features:<ul> <li>Displays <code>ChartsSection</code>.</li> <li>Shows quick summaries of total income vs. expenses.</li> <li>Recent activity feed.</li> </ul> </li> </ul>"},{"location":"frontend_components/#groupmanager-groupmanagertsx","title":"<code>GroupManager</code> (<code>GroupManager.tsx</code>)","text":"<ul> <li>Purpose: Interface for switching and managing groups.</li> <li>Features:<ul> <li>Dropdown to switch active group.</li> <li>Form to create new groups.</li> <li>List of members (with ability to invite new ones).</li> </ul> </li> </ul>"},{"location":"frontend_components/#aiadvisor-aiadvisortsx","title":"<code>AIAdvisor</code> (<code>AIAdvisor.tsx</code>)","text":"<ul> <li>Purpose: Visual interface for the AI financial insights.</li> <li>Features:<ul> <li>\"Generate Advice\" button.</li> <li>Markdown rendering of the AI's response (using <code>react-markdown</code>).</li> </ul> </li> </ul>"},{"location":"frontend_components/#functional-modules","title":"Functional Modules","text":"<p>Each financial entity typically has a Form (Create/Edit) and a List (View/Delete) component.</p> <ul> <li>Bills: <code>BillForm.tsx</code>, <code>BillList.tsx</code>.</li> <li>Incomes: <code>IncomeForm.tsx</code>, <code>IncomeList.tsx</code>.</li> <li>Investments: <code>InvestmentForm.tsx</code>, <code>InvestmentList.tsx</code>.</li> <li>Random Expenses: <code>RandomExpenseForm.tsx</code>, <code>RandomExpenseList.tsx</code>.</li> </ul>"},{"location":"frontend_components/#visualization","title":"Visualization","text":""},{"location":"frontend_components/#chartssection-chartssectiontsx","title":"<code>ChartsSection</code> (<code>ChartsSection.tsx</code>)","text":"<ul> <li>Library: <code>recharts</code>.</li> <li>Charts:<ul> <li>Monthly Expenses Breakdown (Pie Chart).</li> <li>Income vs. Expenses (Bar Chart).</li> </ul> </li> </ul>"},{"location":"project_overview/","title":"Project Overview","text":"<p>Controle Financeiro is a personal finance management application designed for individuals and groups (families/couples). It moves beyond simple spreadsheet tracking by incorporating group management and AI-driven insights.</p>"},{"location":"project_overview/#key-goals","title":"Key Goals","text":"<ol> <li>Centralize Financial Data: Track bills, incomes, and investments in one place.</li> <li>Collaborative Management: Allow multiple users to manage a single financial context (\"Group\").</li> <li>Automated Insights: Use Generative AI to analyze spending habits and suggest improvements.</li> </ol>"},{"location":"project_overview/#technology-stack","title":"Technology Stack","text":"<ul> <li>Frontend: React 19, TypeScript, Tailwind CSS, Vite.</li> <li>Backend: Node.js, Express.</li> <li>Database: PostgreSQL 16.</li> <li>Caching: Redis (for AI response caching).</li> <li>AI: Google Gemini Flash.</li> <li>Infrastructure: Docker Compose.</li> </ul>"},{"location":"project_overview/#current-version","title":"Current Version","text":"<ul> <li>Version: 1.0.0 (Base)</li> <li>Upcoming: 1.0.1 (See Reports &gt; Update Plan).</li> </ul>"},{"location":"security_review/","title":"Security Review","text":""},{"location":"security_review/#authentication-authorization","title":"Authentication &amp; Authorization","text":"<ul> <li>Method: JSON Web Tokens (JWT).</li> <li>Storage: <code>localStorage</code> (Client-side).<ul> <li>Risk: Vulnerable to XSS.</li> <li>Mitigation: <code>helmet</code> on backend prevents some XSS vectors, but moving to HttpOnly cookies is recommended for v2.</li> </ul> </li> <li>Passwords: Hashed using <code>bcryptjs</code> (Salt rounds: 10).</li> </ul>"},{"location":"security_review/#access-control-rbacmulti-tenancy","title":"Access Control (RBAC/Multi-tenancy)","text":"<p>The system enforces strict group-level isolation. - Middleware: <code>requireGroupAccess</code> - Validation: Every request to a financial resource must include <code>X-Group-ID</code>. - Check: The middleware verifies against the database that <code>req.user.id</code> is a member of <code>req.group.id</code>. - SQL Injection: All queries use parameterized queries (<code>pg</code> client), preventing injection attacks.</p>"},{"location":"security_review/#api-security","title":"API Security","text":"<ul> <li>CORS: Enabled via <code>cors</code> middleware.</li> <li>Headers: <code>helmet</code> sets standard security headers (HSTS, No-Sniff, etc.).</li> <li>Rate Limiting: Not currently implemented (Recommended for v1.0.1).</li> </ul>"},{"location":"security_review/#secret-management","title":"Secret Management","text":"<ul> <li>Secrets (API Keys, DB Creds) are loaded via <code>dotenv</code>.</li> <li>Audit: Ensure <code>.env</code> is never committed to git (checked <code>.gitignore</code> and it is present).</li> </ul>"},{"location":"setup_installation/","title":"Setup &amp; Installation","text":""},{"location":"setup_installation/#prerequisites","title":"Prerequisites","text":"<ul> <li>Docker &amp; Docker Compose</li> <li>Node.js 20+ (for local development outside Docker)</li> </ul>"},{"location":"setup_installation/#environment-variables","title":"Environment Variables","text":"<p>Create a <code>.env</code> file in the root <code>controlefinanceiro/</code> directory:</p> <pre><code># Database\nPOSTGRES_USER=postgres\nPOSTGRES_PASSWORD=postgres\nPOSTGRES_DB=financedb\nPOSTGRES_HOST=db\nPOSTGRES_PORT=5432\n\n# Redis\nREDIS_URL=redis://redis:6379\n\n# JWT Secret (Generate a strong random string)\nJWT_SECRET=your_super_secret_jwt_key_here_12345\n\n# Google Gemini API Key\nGEMINI_API_KEY=your_gemini_api_key_here\n\n# Initial Users (Auto-synced on startup)\nAPP_USER_DYONE=dyone.andrade\nAPP_PASS_DYONE=initial_password\nAPP_USER_JULIA=julia.ferreira\nAPP_PASS_JULIA=initial_password\n\n# Frontend API URL (for build)\nVITE_API_URL=http://localhost:3000/api\n</code></pre>"},{"location":"setup_installation/#running-with-docker-recommended","title":"Running with Docker (Recommended)","text":"<p>This starts Postgres, Redis, Backend, and Frontend.</p> <p><pre><code>docker-compose up --build -d\n</code></pre> - Frontend: http://localhost:5173 - Backend: http://localhost:3000</p>"},{"location":"setup_installation/#running-locally-dev-mode","title":"Running Locally (Dev Mode)","text":""},{"location":"setup_installation/#1-start-infrastructure-db-redis","title":"1. Start Infrastructure (DB + Redis)","text":"<p>You still need the databases running. <pre><code>docker-compose up -d db redis\n</code></pre></p>"},{"location":"setup_installation/#2-start-backend","title":"2. Start Backend","text":"<pre><code>cd server\nnpm install\nnpm run dev # or node --watch index.js\n</code></pre>"},{"location":"setup_installation/#3-start-frontend","title":"3. Start Frontend","text":"<pre><code>cd ..\nnpm install\nnpm run dev\n</code></pre>"},{"location":"utilities/","title":"Utility Functions","text":"<p>Helper functions located in <code>src/utils/</code> to standardize logic across the application.</p>"},{"location":"utilities/#financets","title":"<code>finance.ts</code>","text":""},{"location":"utilities/#formatcurrencyvalue-number","title":"<code>formatCurrency(value: number)</code>","text":"<p>Formats a number into BRL currency string (e.g., <code>R$ 1.234,56</code>). - Uses <code>Intl.NumberFormat('pt-BR')</code>.</p>"},{"location":"utilities/#calculatestatusbill-bill","title":"<code>calculateStatus(bill: Bill)</code>","text":"<p>Determines if a bill is <code>paid</code>, <code>pending</code>, or <code>overdue</code>. - Logic:     - If <code>paidDate</code> exists -&gt; Paid.     - If <code>dueDate</code> &lt; Today (start of day) -&gt; Overdue.     - Otherwise -&gt; Pending. - Dependencies: <code>date-fns</code> for accurate date comparison.</p>"},{"location":"utilities/#investmentts","title":"<code>investment.ts</code>","text":""},{"location":"utilities/#calculateinvestmentreturninitial-cdipercent-months","title":"<code>calculateInvestmentReturn(initial, cdiPercent, months)</code>","text":"<p>Projects the future value of an investment based on a fixed CDI rate. - Base Rate: Currently hardcoded at 13.65% a.a. (Needs to be made dynamic/configurable). - Formula: Compound interest monthly. - Usage: Used in the Investment Form simulation to show potential returns.</p>"},{"location":"utilities/#securityts","title":"<code>security.ts</code>","text":""},{"location":"utilities/#token-management","title":"Token Management","text":"<p>Simple wrappers for <code>localStorage</code> to handle the JWT. - <code>getToken()</code>: Retrieves <code>finance_token</code>. - <code>setToken(token)</code>: Saves the token. - <code>removeToken()</code>: Clears the token (Logout).</p>"},{"location":"core_features/ai_advisor/","title":"AI Advisor Feature","text":"<p>The AI Advisor module provides personalized financial insights using Google's Gemini models.</p>"},{"location":"core_features/ai_advisor/#workflow","title":"Workflow","text":"<ol> <li>Data Aggregation: The backend fetches all active records for the current group:<ul> <li>Monthly Incomes</li> <li>Pending and Paid Bills</li> <li>Recent Variable Expenses (Random Expenses)</li> <li>Active Investments</li> </ul> </li> <li>Prompt Engineering: A structured prompt is created, feeding this raw data to the model and requesting a JSON response with specific keys (<code>diagnostico</code>, <code>estrategia</code>, etc.).</li> <li>Model: Uses <code>gemini-flash-latest</code> for low latency and high cost-efficiency.</li> <li>Caching (Redis):<ul> <li>A MD5 hash of the financial data summary is generated.</li> <li>If the same data hash is requested again, the system returns the cached advice from Redis.</li> <li>Cache TTL is set to 24 hours.</li> </ul> </li> </ol>"},{"location":"core_features/ai_advisor/#output","title":"Output","text":"<p>The frontend renders the JSON response into a dashboard displaying: - Diagnosis: A health check of finances. - Action Plan: Concrete steps to improve. - Investment Tips: Suggestions based on surplus.</p>"},{"location":"core_features/bills/","title":"Bills Feature","text":"<p>Manages recurring or scheduled financial obligations.</p>"},{"location":"core_features/bills/#data-model","title":"Data Model","text":"<ul> <li>Name: Description of the bill (e.g., \"Internet\").</li> <li>Value: Amount to be paid.</li> <li>Due Date: When the payment is expected.</li> <li>Status: <code>pending</code> | <code>paid</code> | <code>overdue</code>.</li> </ul>"},{"location":"core_features/bills/#logic","title":"Logic","text":"<ul> <li>Overdue Calculation: The frontend checks if <code>due_date &lt; today</code> AND status is <code>pending</code>.</li> <li>Payment: When a user marks a bill as paid, the backend updates <code>status</code> to <code>paid</code> and sets <code>paid_date</code> to the current timestamp.</li> </ul>"},{"location":"core_features/bills/#components","title":"Components","text":"<ul> <li><code>BillList</code>: Displays bills sorted by due date. Visual cues (red text) for overdue items.</li> <li><code>BillForm</code>: Simple input form.</li> </ul>"},{"location":"core_features/group_management/","title":"Group Management Feature","text":"<p>The application uses a multi-tenant architecture where \"Groups\" act as the tenants. A user can belong to multiple groups, and all financial data is scoped to a specific group.</p>"},{"location":"core_features/group_management/#roles-permissions","title":"Roles &amp; Permissions","text":"<ul> <li>Admin: Can update group name, delete group, invite members, and manage all data.</li> <li>Editor: Can read/write financial data but cannot manage group settings.</li> <li>Viewer: Read-only access (Planned).</li> </ul>"},{"location":"core_features/group_management/#data-isolation","title":"Data Isolation","text":"<ul> <li>Middleware: <code>requireGroupAccess</code> checks if the <code>X-Group-ID</code> header corresponds to a group the user is a member of.</li> <li>Database: Every financial table (<code>bills</code>, <code>incomes</code>, etc.) has a <code>group_id</code> foreign key. Queries are always filtered by <code>group_id</code>.</li> </ul>"},{"location":"core_features/group_management/#invite-system","title":"Invite System","text":"<ul> <li>Admins can invite existing users by their <code>username</code>.</li> <li>The system resolves the username to a <code>user_id</code> and adds a row to <code>group_members</code>.</li> </ul>"},{"location":"core_features/incomes/","title":"Incomes Feature","text":"<p>Tracks all revenue sources for the group.</p>"},{"location":"core_features/incomes/#data-model","title":"Data Model","text":"<ul> <li>Description: Source (e.g., \"Salary\", \"Freelance\").</li> <li>Value: Amount received.</li> <li>Date: Date of receipt.</li> </ul>"},{"location":"core_features/incomes/#usage","title":"Usage","text":"<ul> <li>Used by the <code>Dashboard</code> to calculate \"Total Balance\" (Total Income - Total Expenses).</li> <li>Used by the AI Advisor to determine earning capacity.</li> </ul>"},{"location":"core_features/investments/","title":"Investments Feature","text":"<p>Tracks assets and savings.</p>"},{"location":"core_features/investments/#data-model","title":"Data Model","text":"<ul> <li>Name: Investment title.</li> <li>Initial Amount: Principal invested.</li> <li>CDI %: For fixed income tracking (informational).</li> <li>Start Date: Date of application.</li> <li>Duration: Planned duration in months.</li> </ul>"},{"location":"core_features/investments/#purpose","title":"Purpose","text":"<ul> <li>Currently informational (tracking portfolio).</li> <li>Future updates may include automatic yield calculation based on the CDI index.</li> </ul>"},{"location":"core_features/login_auth/","title":"Login &amp; Authentication Feature","text":"<p>The authentication system is built using JSON Web Tokens (JWT) and BCrypt for password hashing.</p>"},{"location":"core_features/login_auth/#backend-implementation","title":"Backend Implementation","text":"<ul> <li>Library: <code>jsonwebtoken</code>, <code>bcryptjs</code>.</li> <li>Flow:<ol> <li>User submits credentials.</li> <li>Server verifies hash against PostgreSQL <code>users</code> table.</li> <li>If valid, server signs a JWT containing <code>userId</code> and <code>username</code>.</li> <li>Token expires in 8 hours.</li> </ol> </li> <li>Security:<ul> <li>Passwords are salted and hashed (10 rounds).</li> <li><code>helmet</code> is used for basic security headers.</li> <li>Protected routes require <code>Authorization: Bearer &lt;token&gt;</code>.</li> </ul> </li> </ul>"},{"location":"core_features/login_auth/#frontend-implementation","title":"Frontend Implementation","text":"<ul> <li>Context: <code>AuthContext</code> manages the token state.</li> <li>Storage: Token is stored in <code>localStorage</code> to persist across reloads.</li> <li>Interceptor: A custom fetch wrapper (or axios interceptor) automatically attaches the Bearer token to requests.</li> </ul>"},{"location":"core_features/random_expenses/","title":"Random Expenses Feature","text":"<p>Tracks variable, one-off, or unexpected spending.</p>"},{"location":"core_features/random_expenses/#data-model","title":"Data Model","text":"<ul> <li>Name: Description of purchase.</li> <li>Value: Cost.</li> <li>Date: Date of purchase.</li> <li>Status: Defaults to <code>paid</code> (unlike Bills), but supports <code>pending</code> if it's a planned future purchase.</li> </ul>"},{"location":"core_features/random_expenses/#distinction-from-bills","title":"Distinction from Bills","text":"<ul> <li>Bills: Recurring, fixed dates (Rent, Utilities).</li> <li>Random Expenses: Variable, spontaneous (Dinner out, Uber, Emergency repair).</li> </ul>"}]}